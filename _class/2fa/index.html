
<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

    <title>2FA Generator</title>
    <script src="./_js/jquery.min.js"></script>
    <script src="./_js/jquery.mobile.min.js"></script>
    <script src="./_js/jssha.js"></script>
    <script src="./_js/gauth.js"></script>
	<link rel="stylesheet" href="./_css/style.css">

<body class="cmain">
    <div data-role="page" id="main">
        <div data-role="content">
            <ul class="conul">
                <li><input name="amount" id="inputcode" placeholder="Enter 2FA Key" /></li>
                <li>
					<button id="updatekey" class="button primary">
						<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 mr-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
							<line x1="22" y1="2" x2="11" y2="13"></line>
							<polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
						</svg>
					</button>
					<button id="copyButton" class="button primary">
						<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
					</button>
				</li>
				<div id="out-result">
					<li>Code：<span id="codenum" class="txtnum"></span></li>
					<li>Key：<span id="codetxt"></span></li>
					<li>Time Left：<span id="codetime"></span></li>
				</div>
            </ul>
			<p id="webinf">❤️2FA验证码生成器<p>
			<p id="webinf2">📖秘籍：链接后添加 ?key=XXXXX 即可添加书签哦<p>
        </div>
    </div>

    <script>
        // Function to parse query parameters from the URL
		// 127.0.01/index.html?key=123123
        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split('&');
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split('=');
                if (decodeURIComponent(pair[0]) === variable) {
                    return decodeURIComponent(pair[1]);
                }
            }
            return null;
        }

        // Check if the 'key' parameter exists in the URL
        var keyParam = getQueryVariable('key');
        if (keyParam !== null) {
            // Fill the input field with the 'key' parameter
            document.getElementById('inputcode').value = keyParam;
			setTimeout(function() {
				document.getElementById("updatekey").click();
			}, 100);
        }



        // Function to copy text to clipboard
        function copyToClipboard() {
            // Select the text within the 'codenum' element
            var textToCopy = document.getElementById("codenum").textContent;
            // Create a temporary input element to hold the text
            var tempInput = document.createElement("input");
            tempInput.value = textToCopy;
            // Append the input element to the document
            document.body.appendChild(tempInput);
            // Select the text in the input element
            tempInput.select();
            // Copy the selected text to the clipboard
            document.execCommand("copy");
            // Remove the temporary input element
            document.body.removeChild(tempInput);
        }
        // Add a click event listener to the button
        document.getElementById("copyButton").addEventListener("click", copyToClipboard);



        // Generate the verification code using your existing code
        $(document).on('pagecreate', '#main', function() {
            var keysController = new gauth.KeysController();
            keysController.init();
        });
    </script>
</body>
</html>